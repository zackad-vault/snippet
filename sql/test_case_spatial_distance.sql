set @str = '107.5865992008989,-6.928060325430803,0 107.5873543496012,-6.926179727743196,0 107.5909392382846,-6.92612821758518,0 107.5941695384098,-6.926378691168009,0 107.5965657133041,-6.926517268863194,0 107.5996048175014,-6.926629383112773,0 107.6012772704713,-6.926906090652024,0 107.602839551667,-6.927100441772629,0 107.6038404052539,-6.927182178275699,0 107.6038101417688,-6.926378950371861,0 107.6039744754816,-6.924940011229466,0 107.6040469978859,-6.92347365053278,0 107.6040126874496,-6.922258652403547,0 107.603926878068,-6.920492628788132,0 107.6042035225037,-6.91925126267903,0 107.6042562740427,-6.917900587816579,0 107.6042562759297,-6.917790248030598,0 107.6043368604949,-6.916329994591437,0 107.6041991076946,-6.915915553867544,0 107.6032536386917,-6.915943801212856,0 107.6008900838202,-6.916249395304345,0 107.6007513599832,-6.916276840018675,0 107.59491857024,-6.916752835488595,0 107.5906489210315,-6.916866113282989,0 107.5880203338216,-6.916348413282161,0 107.5858071841405,-6.916048157967279,0';
set @str = replace(@str, ',0', ';');
set @str = replace(@str, ',', ' ');
set @str = replace(@str, ';', ',');
set @str = substring(@str, 1, char_length(@str)-1);
set @str = concat('linestring(', @str, ')');
set @pline = geomfromtext(@str);
set @p1 = geomfromtext('point(107.608240 -6.927355)');
#set @pline = geomfromtext('linestring(107.4637 -6.75894, 107.452 -6.3827)');
truncate ci_distance_temp;
select astext(@pline), numpoints(@pline), @str, calc_distance(@p1, @pline);